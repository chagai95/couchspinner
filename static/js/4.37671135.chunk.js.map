{"version":3,"sources":["Messages.js"],"names":["Modal","setAppElement","Messages","messages","userId","names","useState","openThread","setOpenThread","length","map","thread","profileId","ids","parseInt","split","filter","id","pop","otherMemberId","user_ids_concatenated","threadId","created_at","className","key","onClick","body","updated_at","formatDate","isOpen","onRequestClose","contentLabel","message","author_id","dangerouslySetInnerHTML","__html","marked"],"mappings":"kOASAA,IAAMC,cAAc,SAqHLC,UAtGf,YAAgD,IAA5BC,EAA2B,EAA3BA,SAAUC,EAAiB,EAAjBA,OAAQC,EAAS,EAATA,MAAS,EACTC,oBAAS,GADA,mBACtCC,EADsC,KAC1BC,EAD0B,KAG7C,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,iBACA,kBAAC,IAAD,KACGL,EAASM,OACR,oCACGN,EAASO,KAAI,SAAAC,GAAW,IAAD,EAEhBC,EAxBpB,SAAuBC,EAAKT,GAC1B,GAAKS,GAAQT,EAIb,OAAOU,SACLD,EACGE,MAAM,KACNC,QAAO,SAAAC,GAAE,OAAIH,SAASG,EAAI,MAAQb,KAClCc,OAeyBC,CAAa,OAC7BR,QAD6B,IAC7BA,OAD6B,EAC7BA,EAAQS,sBACRhB,GAIIiB,EAAQ,iBAAMV,QAAN,IAAMA,OAAN,EAAMA,EAAQS,sBAAd,mBAAuCT,QAAvC,IAAuCA,OAAvC,EAAuCA,EAAQW,YAE7D,OACE,4BACEC,UAAU,UACVC,IAAKH,EACLI,QAAS,kBACPd,EAAOR,SAASM,OAAS,GAAKD,EAAcG,KAG9C,kBAAC,IAAD,CACEY,UAAU,yBACVlB,MAAOA,EACPY,GAAIL,IAEN,yBAAKW,UAAU,oBACZ,UAAAZ,EAAOR,SAASQ,EAAOR,SAASM,OAAS,UAAzC,eAA6CiB,OAC5C,kBAEJ,8BACS,OAANf,QAAM,IAANA,OAAA,EAAAA,EAAQgB,aACP,0BAAMJ,UAAU,gBACbK,YAAWjB,EAAOgB,aAGvB,6BACA,0BAAMJ,UAAU,iBACc,IAA3BZ,EAAOR,SAASM,QAAgB,eACL,IAA3BE,EAAOR,SAASM,QAAgB,cAChCE,EAAOR,SAASM,OAAS,GAAzB,UACIE,EAAOR,SAASM,OADpB,mBAOX,kBAAC,IAAD,CACEoB,SAAUtB,EACVuB,eAAgB,kBAAMtB,GAAc,IACpCuB,aAAa,kBAEb,yBAAKR,UAAU,kBACb,4BACEA,UAAU,uBACVE,QAAS,kBAAMjB,GAAc,KAF/B,QAMCD,GACCA,EAAWJ,SAASO,KAAI,SAAAsB,GAAO,OAC7B,yBAAKT,UAAU,yBAAyBC,IAAKQ,EAAQf,IACnD,yBAAKM,UAAU,gBACb,kBAAC,IAAD,CACEA,UAAU,yBACVN,GAAE,OAAEe,QAAF,IAAEA,OAAF,EAAEA,EAASC,UACb5B,MAAOA,EACPD,OAAQA,KAEC,OAAVG,QAAU,IAAVA,OAAA,EAAAA,EAAYoB,aACX,0BAAMJ,UAAU,gBACbK,YAAWI,EAAQL,eAIlB,OAAPK,QAAO,IAAPA,OAAA,EAAAA,EAASN,OACR,yBACEQ,wBAAyB,CACvBC,OAAQC,IAAM,OAACJ,QAAD,IAACA,OAAD,EAACA,EAASN,WAI7B,OAACM,QAAD,IAACA,OAAD,EAACA,EAASN,OAAQ,oDAO/B","file":"static/js/4.37671135.chunk.js","sourcesContent":["import React, { useState } from 'react';\nimport marked from 'marked';\nimport Modal from 'react-modal';\n\nimport './Messages.scss';\nimport { formatDate } from './utils';\nimport { Section, Heading, Content, CsProfileName } from './components';\n\n// http://reactcommunity.org/react-modal/accessibility/\nModal.setAppElement('#root');\n\nfunction otherMemberId(ids, userId) {\n  if (!ids || !userId) {\n    return;\n  }\n\n  return parseInt(\n    ids\n      .split(',')\n      .filter(id => parseInt(id, 10) !== userId)\n      .pop(),\n  );\n}\n\nfunction Messages({ messages, userId, names }) {\n  const [openThread, setOpenThread] = useState(false);\n\n  return (\n    <Section>\n      <Heading>Messages</Heading>\n      <Content>\n        {messages.length ? (\n          <>\n            {messages.map(thread => {\n              // Other profile IDs than your own\n              const profileId = otherMemberId(\n                thread?.user_ids_concatenated,\n                userId,\n              );\n\n              // Unique ID for message thread\n              const threadId = `${thread?.user_ids_concatenated}-${thread?.created_at}`;\n\n              return (\n                <button\n                  className=\"Message\"\n                  key={threadId}\n                  onClick={() =>\n                    thread.messages.length > 0 && setOpenThread(thread)\n                  }\n                >\n                  <CsProfileName\n                    className=\"Profile-reference-type\"\n                    names={names}\n                    id={profileId}\n                  />\n                  <div className=\"Message-preview\">\n                    {thread.messages[thread.messages.length - 1]?.body ||\n                      'Empty message.'}\n                  </div>\n                  <div>\n                    {thread?.updated_at && (\n                      <span className=\"Message-date\">\n                        {formatDate(thread.updated_at)}\n                      </span>\n                    )}\n                    <br />\n                    <span className=\"Message-count\">\n                      {thread.messages.length === 0 && 'No messages.'}\n                      {thread.messages.length === 1 && 'One message'}\n                      {thread.messages.length > 1 &&\n                        `${thread.messages.length} messages`}\n                    </span>\n                  </div>\n                </button>\n              );\n            })}\n            <Modal\n              isOpen={!!openThread}\n              onRequestClose={() => setOpenThread(false)}\n              contentLabel=\"Message thread\"\n            >\n              <div className=\"Message-thread\">\n                <button\n                  className=\"Message-thread-close\"\n                  onClick={() => setOpenThread(false)}\n                >\n                  Ã—\n                </button>\n                {openThread &&\n                  openThread.messages.map(message => (\n                    <div className=\"Message-thread-message\" key={message.id}>\n                      <div className=\"Message-meta\">\n                        <CsProfileName\n                          className=\"Profile-reference-type\"\n                          id={message?.author_id}\n                          names={names}\n                          userId={userId}\n                        />\n                        {openThread?.updated_at && (\n                          <span className=\"Message-date\">\n                            {formatDate(message.updated_at)}\n                          </span>\n                        )}\n                      </div>\n                      {message?.body && (\n                        <div\n                          dangerouslySetInnerHTML={{\n                            __html: marked(message?.body),\n                          }}\n                        />\n                      )}\n                      {!message?.body && <p>Empty message.</p>}\n                    </div>\n                  ))}\n              </div>\n            </Modal>\n          </>\n        ) : (\n          <p>No messages. :-(</p>\n        )}\n      </Content>\n    </Section>\n  );\n}\n\nexport default Messages;\n"],"sourceRoot":""}